<!doctype html><html lang=zh-cn dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Ssh Hugo | withme's blog</title>
<meta name=keywords content><meta name=description content="summary
hugo is a popular static site builder.We need to edit the site file in markdown format in our computer.When we want to publish our site,we need to push the code to the remote computer.So that,for convenience,I write a bash script to automatically complete the task.
code
In the below code,I run the cloudflared,because my remote host has only ipv6,and my virtual machine can&rsquo;t access the ipv6 network conveniently.Through cloudflared,I use it to get achieve an effect like proxy."><meta name=author content="withme"><link rel=canonical href=https://blog.withme.top/posts/ssh-hugo/><meta name=google-site-verification content="G-P3Z1RE78CQ"><link crossorigin=anonymous href=/assets/css/stylesheet.css rel="preload stylesheet" as=style><link rel=icon href=https://blog.withme.top/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.withme.top/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.withme.top/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.withme.top/apple-touch-icon.png><link rel=mask-icon href=https://blog.withme.top/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh-cn href=https://blog.withme.top/posts/ssh-hugo/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><meta property="og:url" content="https://blog.withme.top/posts/ssh-hugo/"><meta property="og:site_name" content="withme's blog"><meta property="og:title" content="Ssh Hugo"><meta property="og:description" content="summary hugo is a popular static site builder.We need to edit the site file in markdown format in our computer.When we want to publish our site,we need to push the code to the remote computer.So that,for convenience,I write a bash script to automatically complete the task.
code In the below code,I run the cloudflared,because my remote host has only ipv6,and my virtual machine can’t access the ipv6 network conveniently.Through cloudflared,I use it to get achieve an effect like proxy."><meta property="og:locale" content="zh-cn"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-04-25T00:00:00+00:00"><meta property="article:modified_time" content="2025-04-25T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Ssh Hugo"><meta name=twitter:description content="summary
hugo is a popular static site builder.We need to edit the site file in markdown format in our computer.When we want to publish our site,we need to push the code to the remote computer.So that,for convenience,I write a bash script to automatically complete the task.
code
In the below code,I run the cloudflared,because my remote host has only ipv6,and my virtual machine can&rsquo;t access the ipv6 network conveniently.Through cloudflared,I use it to get achieve an effect like proxy."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.withme.top/posts/"},{"@type":"ListItem","position":2,"name":"Ssh Hugo","item":"https://blog.withme.top/posts/ssh-hugo/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Ssh Hugo","name":"Ssh Hugo","description":"summary hugo is a popular static site builder.We need to edit the site file in markdown format in our computer.When we want to publish our site,we need to push the code to the remote computer.So that,for convenience,I write a bash script to automatically complete the task.\ncode In the below code,I run the cloudflared,because my remote host has only ipv6,and my virtual machine can\u0026rsquo;t access the ipv6 network conveniently.Through cloudflared,I use it to get achieve an effect like proxy.\n","keywords":[],"articleBody":"summary hugo is a popular static site builder.We need to edit the site file in markdown format in our computer.When we want to publish our site,we need to push the code to the remote computer.So that,for convenience,I write a bash script to automatically complete the task.\ncode In the below code,I run the cloudflared,because my remote host has only ipv6,and my virtual machine can’t access the ipv6 network conveniently.Through cloudflared,I use it to get achieve an effect like proxy.\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 #!/bin/bash HUGO_DIR= REMOTE_USER= WRB_DIR= CLOUDFLARED_HOSTNAME= LOCAL_PORT= CLOUDFLARED_PATH=/home/lxz/app/cloudflared/cloudflared # 暂时性使用cloudflared nohup $CLOUDFLARED_PATH access tcp --hostname $CLOUDFLARED_HOSTNAME --url 127.0.0.1:$LOCAL_PORT \u003e/dev/null 2\u003e/dev/null \u0026 cd $HUGO_DIR # 构建 hugo # 上传到github git add . git commit -m \"$(date)\" git push # 压缩 cd $HUGO_DIR/public tar -cf site.tar.gz * # sftp 上传 sftp -P $LOCAL_PORT $REMOTE_USER@127.0.0.1 \u003c","wordCount":"234","inLanguage":"zh-cn","datePublished":"2025-04-25T00:00:00Z","dateModified":"2025-04-25T00:00:00Z","author":{"@type":"Person","name":"withme"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.withme.top/posts/ssh-hugo/"},"publisher":{"@type":"Organization","name":"withme's blog","logo":{"@type":"ImageObject","url":"https://blog.withme.top/favicon.ico"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.withme.top/ accesskey=h title="withme (Alt + H)">withme</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Ssh Hugo</h1><div class=post-meta><span title='2025-04-25 00:00:00 +0000 UTC'>2025-04-25</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;234 words&nbsp;·&nbsp;withme</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#summary aria-label=summary>summary</a></li><li><a href=#code aria-label=code>code</a></li></ul></div></details></div><div class=post-content><h3 id=summary>summary<a hidden class=anchor aria-hidden=true href=#summary>#</a></h3><p>hugo is a popular static site builder.We need to edit the site file in markdown format in our computer.When we want to publish our site,we need to push the code to the remote computer.So that,for convenience,I write a bash script to automatically complete the task.</p><h3 id=code>code<a hidden class=anchor aria-hidden=true href=#code>#</a></h3><p>In the below code,I run the cloudflared,because my remote host has only ipv6,and my virtual machine can&rsquo;t access the ipv6 network conveniently.Through cloudflared,I use it to get achieve an effect like proxy.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=nv>HUGO_DIR</span><span class=o>=</span>&lt;your hugo dir&gt;
</span></span><span class=line><span class=cl><span class=nv>REMOTE_USER</span><span class=o>=</span>&lt;your remote machine user&gt;
</span></span><span class=line><span class=cl><span class=nv>WRB_DIR</span><span class=o>=</span>&lt;your website dir&gt;
</span></span><span class=line><span class=cl><span class=nv>CLOUDFLARED_HOSTNAME</span><span class=o>=</span>&lt;your cloudflared domain&gt;
</span></span><span class=line><span class=cl><span class=nv>LOCAL_PORT</span><span class=o>=</span>&lt;the port to establish the network bridge with cloudflare&gt;
</span></span><span class=line><span class=cl><span class=nv>CLOUDFLARED_PATH</span><span class=o>=</span>/home/lxz/app/cloudflared/cloudflared
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 暂时性使用cloudflared</span>
</span></span><span class=line><span class=cl>nohup <span class=nv>$CLOUDFLARED_PATH</span> access tcp --hostname <span class=nv>$CLOUDFLARED_HOSTNAME</span> --url 127.0.0.1:<span class=nv>$LOCAL_PORT</span> &gt;/dev/null 2&gt;/dev/null <span class=p>&amp;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>cd</span> <span class=nv>$HUGO_DIR</span>
</span></span><span class=line><span class=cl><span class=c1># 构建</span>
</span></span><span class=line><span class=cl>hugo
</span></span><span class=line><span class=cl><span class=c1># 上传到github</span>
</span></span><span class=line><span class=cl>git add .
</span></span><span class=line><span class=cl>git commit -m <span class=s2>&#34;</span><span class=k>$(</span>date<span class=k>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>git push
</span></span><span class=line><span class=cl><span class=c1># 压缩</span>
</span></span><span class=line><span class=cl><span class=nb>cd</span> <span class=nv>$HUGO_DIR</span>/public
</span></span><span class=line><span class=cl>tar -cf site.tar.gz *
</span></span><span class=line><span class=cl><span class=c1># sftp 上传</span>
</span></span><span class=line><span class=cl>sftp -P <span class=nv>$LOCAL_PORT</span> <span class=nv>$REMOTE_USER</span>@127.0.0.1  <span class=s>&lt;&lt;EOF
</span></span></span><span class=line><span class=cl><span class=s>cd /home/$REMOTE_USER
</span></span></span><span class=line><span class=cl><span class=s>put site.tar.gz
</span></span></span><span class=line><span class=cl><span class=s>bye
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl><span class=c1># ssh 控制</span>
</span></span><span class=line><span class=cl>ssh <span class=s2>&#34;</span><span class=nv>$REMOTE_USER</span><span class=s2>@127.0.0.1&#34;</span> -p <span class=s2>&#34;</span><span class=nv>$LOCAL_PORT</span><span class=s2>&#34;</span> <span class=s2>&#34;
</span></span></span><span class=line><span class=cl><span class=s2>    cd </span><span class=nv>$WRB_DIR</span><span class=s2> &amp;&amp; \
</span></span></span><span class=line><span class=cl><span class=s2>    rm -rf ./* &amp;&amp; \
</span></span></span><span class=line><span class=cl><span class=s2>    mv /home/</span><span class=nv>$REMOTE_USER</span><span class=s2>/site.tar.gz . &amp;&amp; \
</span></span></span><span class=line><span class=cl><span class=s2>    tar xf site.tar.gz &amp;&amp; \
</span></span></span><span class=line><span class=cl><span class=s2>    rm site.tar.gz
</span></span></span><span class=line><span class=cl><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 关闭 cloudflared</span>
</span></span><span class=line><span class=cl>pkill -f cloudflared
</span></span><span class=line><span class=cl><span class=c1># 删除本地文件</span>
</span></span><span class=line><span class=cl>rm site.tar.gz
</span></span></code></pre></td></tr></table></div></div></div><footer class=post-footer><ul class=post-tags></ul></footer></article></main><footer class=footer><span>版权归 withme.top 所有</span> ·
热爱生活 ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>